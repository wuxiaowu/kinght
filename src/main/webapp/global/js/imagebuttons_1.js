/*--------------------------------------------------|
| imagebutton |                                     |
|---------------------------------------------------|
|                                                   |
| This script  use  to be defined  the buttons'     |
| image source                                      |
|                                                   |
| Created: 02.09.2006   Alan Ray                    |
|                                                   |
| updated:                                          |
|                                                   |
| updated:on 060906 by yc                           |
|                                                   |
|                                                   |
|--------------------------------------------------*/

//top??????: button1
//?????????UP??????????????????????????????
var imagesDir="../global/images/";
button1up=new Image(16,16);
button1up.src=imagesDir+"nav_top_over.gif";
//?????????down??????????????????????????????
button1down=new Image(16,16);
button1down.src=imagesDir+"nav_top_up.gif";
//top_disable??????: button1
//?????????Disable_UP??????????????????????????????
button11up=new Image(16,16);
button11up.src=imagesDir+"nav_top_dis_over.gif";
//?????????Disable_down??????????????????????????????
button11down=new Image(16,16);
button11down.src=imagesDir+"nav_top_dis_up.gif";

//back??????: button2
//?????????UP??????????????????????????????
button2up=new Image(16,16);
button2up.src=imagesDir+"nav_back_over.gif";
//?????????down??????????????????????????????
button2down=new Image(16,16);
button2down.src=imagesDir+"nav_back_up.gif";
//back_disable??????: button21
//?????????Disable_UP??????????????????????????????
button21up=new Image(16,16);
button21up.src=imagesDir+"nav_back_dis_over.gif";
//?????????Disable_down??????????????????????????????
button21down=new Image(16,16);
button21down.src=imagesDir+"nav_back_dis_up.gif";

//next??????: button3
//?????????UP??????????????????????????????
button3up=new Image(16,16);
button3up.src=imagesDir+"nav_next_over.gif";
//?????????down??????????????????????????????
button3down=new Image(16,16);
button3down.src=imagesDir+"nav_next_up.gif";
//next_disable??????: button31
//?????????Disable_UP??????????????????????????????
button31up=new Image(16,16);
button31up.src=imagesDir+"nav_next_dis_over.gif";
//?????????Disable_down??????????????????????????????
button31down=new Image(16,16);
button31down.src=imagesDir+"nav_next_dis_up.gif";

//end??????: button4
//?????????UP??????????????????????????????
button4up=new Image(16,16);
button4up.src=imagesDir+"nav_end_over.gif";
//?????????down??????????????????????????????
button4down=new Image(16,16);
button4down.src=imagesDir+"nav_end_up.gif";
//end_disable??????: button41
//?????????Disable_UP??????????????????????????????
button41up=new Image(16,16);
button41up.src=imagesDir+"nav_end_dis_over.gif";
//?????????Disable_down??????????????????????????????
button41down=new Image(16,16);
button41down.src=imagesDir+"nav_end_dis_up.gif";

//go??????: button5
//?????????UP??????????????????????????????
button5up=new Image(16,16);
button5up.src=imagesDir+"nav_go_over.gif";
//?????????down??????????????????????????????
button5down=new Image(16,16);
button5down.src=imagesDir+"nav_go_up.gif";
//???????????????button6,button7
//?????????Disable_UP??????????????????????????????
button6up=new Image(16,16);
button6up.src=imagesDir+"btn_sort_a_over.gif";
button7up=new Image(16,16);
button7up.src=imagesDir+"btn_sort_d_over.gif";
//?????????Disable_down??????????????????????????????
button6down=new Image(16,16);
button6down.src=imagesDir+"btn_sort_a.gif";
button7down=new Image(16,16);
button7down.src=imagesDir+"btn_sort_d.gif";
//////////////////////////////////////////////////////////////////
// ????????????                                                     //
// created:060822 by yc                                         //
// edited :060911 by yc                                         //
// edited :060920 by yc                                         //
//////////////////////////////////////////////////////////////////

//==========???????????????????????????=============
window.attachEvent("onresize",function(){});

function getParent(element,level){
 var retElement=element;
   for(i=0;i<level;i++){
    retElement=retElement.parentElement;
   }
 return retElement;
}

//======dataMap:??????????????????================
var dataMap = {
	put : function(key,value) {this[key] = value;},
	get : function(key) {return this[key];}
}
//=============
function getSelectedRowByEventElement(eventElement){
	if(eventElement.tagName=="TR"){
		return eventElement;
	}else{
		return getSelectedRowByEventElement(eventElement.parentElement);
	}
}

//???????????????????????? by dgc,2006-12-16=========begin===================
function alterTrBgColor(objTb,newClass,oldClass)
{	
	if(event.srcElement.tagName=="TBODY"||event.srcElement.tagName=="TABLE"){return;} //?????????????????????????????????
	  	
	var objTr=event.srcElement.parentElement;//???????????????
	
    if(objTr.tagName=="TH"||event.srcElement.tagName=="TH")//????????????????????????(???????????????????????????)???????????????
     return; 
 
    objTr=getSelectedRowByEventElement(event.srcElement);
  
   if(objTr.className!=""&&objTr.className!=newClass&&objTr.className!=oldClass)
     return;//??????tr???????????????????????????class,?????????

	var preSelectedRow=objTb.preSelectedRow;

	if(preSelectedRow)
	   preSelectedRow.className=oldClass;
	objTr.className=newClass;
	objTb.preSelectedRow=objTr;
}
//===================================end====================

//??????????????????select????????????????????????????????? by dgc 2006-12-21==begin============================
window.attachEvent('onload',configDivsForSelectBox);

function configDivsForSelectBox(divs){
var divs=document.getElementsByTagName("DIV");
for(var i=0;i<divs.length;i++){
	var thisDiv=divs[i];
	
	if(!thisDiv.getElementsByTagName('THEAD')[0]||!thisDiv.getElementsByTagName('SELECT')[0])
	{
		continue;
	}
	var thisContainer=thisDiv;
	
	var thisHeader=thisContainer.getElementsByTagName('THEAD')[0];
	var ths=thisHeader.getElementsByTagName("th");
    if(ths[ths.length-1].className!="fixedHeaderTh"&&ths[ths.length-1].className!="fixedHeader_bith"){continue;}//?????????????????????????????????????????????????????????????????????????????????
	                                                           //??????????????????select??????
															   
    var _offset=getOffsetForFixedRows(thisContainer);
    toggleSelectBoxes(thisContainer,_offset);
    addIEonScroll(thisContainer,_offset);
}
}

function getOffsetForFixedRows(thisDiv){//??????_offset???
    var _offset=0;//????????????select??????????????????????????????????????????
	var thisContainer = thisDiv;
    var trs=thisContainer.getElementsByTagName("tr");
	var count=0;
	for(var i=0;i<trs.length;i++){
		if(trs[i].className.indexOf("fixed_total_tr")==0){
			_offset+=trs[i].clientHeight;
			count++;
		}
	}
  _offset=count==0?0:_offset+_offset/count;
  return _offset;
}

function toggleSelectBoxes(thisDiv,_offset) {//_offset:????????????select??????????????????????????????????????????
	var thisContainer = thisDiv;
	var thisHeader = thisContainer.getElementsByTagName('THEAD')[0];
	var selectBoxes = thisContainer.getElementsByTagName('select');

	for (var i = 0; i < selectBoxes.length; i++) {
		if (thisContainer.scrollTop > eval(selectBoxes[i].parentNode.offsetTop - thisHeader.offsetHeight)||
		    thisContainer.scrollTop < eval(selectBoxes[i].parentNode.offsetTop
		                           - (thisContainer.clientHeight-_offset))) {

			selectBoxes[i].style.visibility = 'hidden';
		} else {
			selectBoxes[i].style.visibility = 'visible';
		}
	}
} 

function addIEonScroll(thisDiv,_offset) {
	var thisContainer = thisDiv;

	thisContainer.onscroll =function(){
		toggleSelectBoxes(thisContainer,_offset);
	};
}

//======end===================================================

//?????????????????????,?????????alterTrBgColor()??????????????? by dgc 2006-12-22====begin================
function updownRow(tbId,orientation){
	if(orientation!="up"&&orientation!="down"){
		alert("??????????????? up ?????? down");return;
	}
    var objTb=document.getElementById(tbId);
	var selectedRow=objTb.preSelectedRow;//?????????alterTrBgColor()?????????
	if(!selectedRow){
		alert("???????????????!");return;
	}
	if(orientation=="up"&&selectedRow.rowIndex>0){
	 selectedRow.swapNode(objTb.rows(selectedRow.rowIndex-1));
	}else if(orientation=="down"&&selectedRow.rowIndex<objTb.rows.length-1){
	 selectedRow.swapNode(objTb.rows(selectedRow.rowIndex+1));
	}
}
//===============end=======================================



//ID ??????
var ArrID=new Array();
//??????tr????????????
var ArrtrObj=new Array();
//??????tr???
function LastTr(trIndex){
	this.Index=trIndex;
	}
//????????????????????????
function SetCurObjTRColor(trID,trIndex,curColorStyle,ColorStyle){
         //???????????????????????????????????????	      
		  var isInArrID=false;
		  var objIndex;
		  for(var i=0;i<ArrID.length;i++){
			  if(ArrID[i]==trID){
				 isInArrID=true;
				 objIndex=i;
				 break;}
			  }
	      if(!isInArrID){
			  ArrID[ArrID.length]=trID;
			  ArrtrObj[ArrtrObj.length]=new LastTr(trIndex);
			  objIndex=ArrtrObj.length-1;
			  }
			 // alert(objIndex);
		 //????????????ID???????????????ID
		 var objID=trID+trIndex;
		 var objLastID=trID+ArrtrObj[objIndex].Index;
		 //???????????????????????????????????????
		 var curObjTR=document.getElementById(objID);
		 var lastObjTR=document.getElementById(objLastID);
		 if(lastObjTR&&lastObjTR!=undefined)
         	lastObjTR.className=ColorStyle ;		  
		 curObjTR.className=curColorStyle ;
		 ArrtrObj[objIndex].Index=trIndex ;
		}
		
var tempTr,tempClass;
function setTrColor(trObj,defaultClass,curClass){
      if (tempTr != undefined)
        tempTr.className=tempClass;
      trObj.className=curClass;
      tempTr = trObj;
      tempClass = defaultClass;
    }
    
//??????????????????
//??????
function  trGoUp(trID){
          //???????????????????????????????????????	      
		  var isInArrID=false;
		  var objIndex;
		  for(var i=0;i<ArrID.length;i++){
			if(ArrID[i]==trID){
			  isInArrID=true;
			  objIndex=i;
			  break;
		    }
		  }
		  if(isInArrID){
	    	var objID=trID+ArrtrObj[objIndex].Index;
		    var curObjTR=document.getElementById(objID);
			var curObjTable=curObjTR;
			while(curObjTable.tagName.toUpperCase()!="TABLE"){
			  curObjTable=curObjTable.parentNode;
			}
		    var trIndex=curObjTR.rowIndex; 
			if (trIndex>0) {
              curObjTable.rows(trIndex).swapNode(curObjTable.rows(trIndex-1));
            }
		  }
}
//??????
function  trGoDown(trID){
          //???????????????????????????????????????	      
		  var isInArrID=false;
		  var objIndex;
		  for(var i=0;i<ArrID.length;i++){
			if(ArrID[i]==trID){
			  isInArrID=true;
			  objIndex=i;
			  break;
		    }
		  }
		  if(isInArrID){
	    	var objID=trID+ArrtrObj[objIndex].Index;
		    var curObjTR=document.getElementById(objID);
			var curObjTable=curObjTR;
			while(curObjTable.tagName.toUpperCase()!="TABLE"){
			  curObjTable=curObjTable.parentNode;
			}
		    var trIndex=curObjTR.rowIndex; 
			if (trIndex<curObjTable.rows.length-1) {
              curObjTable.rows(trIndex).swapNode(curObjTable.rows(trIndex+1));
            }
		  }
}	